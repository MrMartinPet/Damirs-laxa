<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8" />
<title>Nordisk geografi ‚Äì karta</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body{
    margin:0;
    padding:12px;
    font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
    background:#f5f5f5;
  }
  h1{
    font-size:1.4rem;
    text-align:center;
    margin:4px 0 2px;
  }
  .subtitle{
    text-align:center;
    font-size:0.9rem;
    color:#555;
    margin-bottom:10px;
  }
  .card{
    background:#fff;
    border-radius:14px;
    box-shadow:0 2px 6px rgba(0,0,0,.15);
    padding:10px;
    max-width:640px;
    margin:0 auto;
  }
  .map{
    position:relative;
    width:100%;
    aspect-ratio:3/4;
    border-radius:12px;
    background:#e6e6dd url("nordenkarta.jpg") center/contain no-repeat;
    overflow:hidden;
  }
  .point{
    position:absolute;
    transform:translate(-50%,-50%);
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:2px;
  }
  .point-label{
    font-size:0.6rem;
    padding:2px 4px;
    background:rgba(255,255,255,.8);
    border-radius:6px;
  }
  .point input{
    width:80px;
    max-width:22vw;
    font-size:0.6rem;
    padding:3px 4px;
    border-radius:6px;
    border:1px solid #bbb;
    text-align:center;
    background:rgba(255,255,255,.9);
  }
  .point.country input{
    width:100px;
    max-width:26vw;
  }
  .flag{
    font-size:0.9rem;
    min-height:1.1rem;
  }
  .correct{
    border-color:#1b8c1b !important;
    background:rgba(210,244,210,.9) !important;
  }
  .wrong{
    border-color:#c41b1b !important;
    background:rgba(248,214,214,.9) !important;
  }
  #info{
    margin-top:8px;
    font-size:0.8rem;
    color:#444;
  }
  #score{
    margin-top:4px;
    font-size:0.85rem;
    font-weight:600;
  }
  #buttons{
    display:flex;
    gap:6px;
    margin-top:8px;
  }
  button{
    flex:1;
    padding:8px 0;
    border-radius:999px;
    border:none;
    font-size:0.9rem;
    cursor:pointer;
  }
  #checkAllBtn{ background:#007aff; color:#fff; }
  #showAllBtn{ background:#e0e0e0; }
</style>
</head>
<body>
<h1>Nordisk geografi ‚Äì karta</h1>
<div class="subtitle">Fyll i l√§nder + huvudst√§der, √∂ar, sj√∂ar och hav/sund/vikar.</div>

<div class="card">
  <div class="map" id="map"></div>

  <div id="info">
    F√∂r l√§nderna skriver du <strong>land + huvudstad</strong>, t.ex.
    <em>Sverige Stockholm</em> eller <em>Sverige, Stockholm</em>.
    N√§r ett land √§r r√§tt visas r√§tt flagga.
  </div>
  <div id="score"></div>

  <div id="buttons">
    <button id="checkAllBtn">Kolla alla</button>
    <button id="showAllBtn">Visa facit</button>
  </div>
</div>

<script>
// =========================
// Data: 19 platser
// =========================

const COUNTRIES = [
  { id:"se", country:"sverige", capital:"stockholm", left:47, top:63, flag:"üá∏üá™" },
  { id:"no", country:"norge",  capital:"oslo",      left:30, top:45, flag:"üá≥üá¥" },
  { id:"dk", country:"danmark",capital:"k√∂penhamn",left:34, top:77, flag:"üá©üá∞", altCap:["kopenhamn","copenhagen"] },
  { id:"fi", country:"finland",capital:"helsingfors",left:63, top:48, flag:"üá´üáÆ", altCap:["helsinki"] },
  { id:"is", country:"island", capital:"reykjavik", left:10, top:30, flag:"üáÆüá∏", altCap:["reykjav√≠k"] }
];

const ISLANDS = [
  { id:"gotland", name:"gotland", left:55, top:68, label:"√ñ" },
  { id:"oland",   name:"√∂land",   left:53, top:74, label:"√ñ" },
  { id:"aland",   name:"√•land",   left:54, top:51, label:"√ñ" }
];

const LAKES = [
  { id:"vanern",  name:"v√§nern",  left:43, top:59, label:"Sj√∂" },
  { id:"vatttern",name:"v√§ttern", left:46, top:64, label:"Sj√∂" },
  { id:"malar",   name:"m√§laren", left:47, top:56, label:"Sj√∂" }
];

const WATERS = [
  { id:"ostersjon", name:["√∂stersj√∂n","ostersjon"], left:60, top:64, label:"Hav" },
  { id:"nordsjon",  name:["nordsj√∂n","nordsjon"],   left:20, top:50, label:"Hav" },
  { id:"bottenhavet", name:["bottenhavet"],         left:52, top:42, label:"Hav" },
  { id:"bottenviken", name:["bottenviken"],         left:55, top:31, label:"Vik" },
  { id:"finska",   name:["finska viken","finskaviken"], left:73, top:50, label:"Vik" },
  { id:"skagerrak", name:["skagerrak"],             left:32, top:62, label:"Sund" },
  { id:"kattegatt", name:["kattegatt"],             left:30, top:69, label:"Sund" },
  { id:"oresund",   name:["√∂resund","oresund"],     left:37, top:75, label:"Sund" }
];

const ITEMS = [];

// L√§nder (land + huvudstad i samma ruta)
COUNTRIES.forEach(c => {
  ITEMS.push({
    id: "country-"+c.id,
    type: "country",
    left: c.left,
    top: c.top,
    label: "Land + huvudstad",
    country: c.country,
    capital: c.capital,
    altCap: c.altCap || [],
    flag: c.flag
  });
});

// √ñar
ISLANDS.forEach(o => {
  ITEMS.push({
    id: "island-"+o.id,
    type: "island",
    left: o.left,
    top: o.top,
    label: o.label,
    answers: [o.name]
  });
});

// Sj√∂ar
LAKES.forEach(s => {
  ITEMS.push({
    id: "lake-"+s.id,
    type: "lake",
    left: s.left,
    top: s.top,
    label: s.label,
    answers: [s.name]
  });
});

// Hav / sund / vikar
WATERS.forEach(w => {
  ITEMS.push({
    id: "water-"+w.id,
    type: "water",
    left: w.left,
    top: w.top,
    label: w.label,
    answers: Array.isArray(w.name) ? w.name : [w.name]
  });
});

// =========================
// Hj√§lpfunktioner
// =========================

function normalize(str){
  return str
    .toLowerCase()
    .trim()
    .replaceAll("√•","a")
    .replaceAll("√§","a")
    .replaceAll("√∂","o")
    .replaceAll("¬¥","")
    .replaceAll("`","")
    .replaceAll("‚Äô","")
    .replace(/[^a-z0-9 ]+/g," ")
    .replace(/\s+/g," ");
}

const mapEl = document.getElementById("map");
const scoreEl = document.getElementById("score");
const state = {}; // id -> {input, flagEl, correct}

// Bygg alla punkter p√• kartan
ITEMS.forEach(item => {
  const wrap = document.createElement("div");
  wrap.className = "point " + item.type;
  wrap.style.left = item.left + "%";
  wrap.style.top  = item.top  + "%";

  const label = document.createElement("div");
  label.className = "point-label";
  label.textContent = item.label;
  wrap.appendChild(label);

  const input = document.createElement("input");
  input.type = "text";
  input.dataset.id = item.id;
  input.autocomplete = "off";
  input.inputMode = "text";
  if(item.type === "country"){
    input.placeholder = "t.ex. Sverige Stockholm";
  }
  wrap.appendChild(input);

  let flagEl = null;
  if(item.type === "country"){
    flagEl = document.createElement("div");
    flagEl.className = "flag";
    flagEl.textContent = "";
    wrap.appendChild(flagEl);
  }

  mapEl.appendChild(wrap);
  state[item.id] = { item, input, flagEl, correct:false };

  // Enter = kolla just den rutan
  input.addEventListener("keydown", e => {
    if(e.key === "Enter"){
      checkOne(item.id);
      input.blur();
    }
  });

  input.addEventListener("blur", () => {
    if(input.value.trim()!==""){
      checkOne(item.id);
    }
  });
});

// Kolla en ruta
function checkOne(id){
  const { item, input, flagEl } = state[id];
  const val = input.value;
  const norm = normalize(val);
  let ok = false;

  if(item.type === "country"){
    const c = normalize(item.country);
    const capMain = normalize(item.capital);
    const altCaps = item.altCap.map(normalize);

    ok = norm.includes(c) &&
         (norm.includes(capMain) || altCaps.some(a => norm.includes(a)));
  } else {
    ok = item.answers.some(ans => normalize(ans) === norm);
  }

  if(ok){
    input.classList.remove("wrong");
    input.classList.add("correct");
    state[id].correct = true;
    if(flagEl){
      flagEl.textContent = item.flag;
    }
  } else {
    input.classList.remove("correct");
    input.classList.add("wrong");
    state[id].correct = false;
  }
  updateScore();
}

// Kolla alla
function checkAll(){
  Object.keys(state).forEach(id => {
    if(state[id].input.value.trim()!==""){
      checkOne(id);
    }
  });
  updateScore();
}

// Facit
function showAll(){
  Object.values(state).forEach(({item,input,flagEl}) => {
    if(item.type === "country"){
      input.value = capitalize(item.country) + " " + capitalize(item.capital);
      if(flagEl) flagEl.textContent = item.flag;
    } else {
      input.value = capitalize(item.answers[0]);
    }
    input.classList.add("correct");
    input.classList.remove("wrong");
    state[item.id].correct = true;
  });
  updateScore();
}

function capitalize(str){
  if(!str) return "";
  return str.charAt(0).toUpperCase() + str.slice(1);
}

function updateScore(){
  const total = ITEMS.length; // 19
  let correct = 0;
  Object.values(state).forEach(s => { if(s.correct) correct++; });
  scoreEl.textContent = `R√§tt placerade: ${correct} av ${total}`;
}

// Koppla knappar
document.getElementById("checkAllBtn").addEventListener("click", checkAll);
document.getElementById("showAllBtn").addEventListener("click", showAll);
</script>
</body>
</html>