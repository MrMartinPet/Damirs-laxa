<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Norden ‚Äì geografi</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body{
    margin:0;
    padding:10px;
    font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
    background:#f4f4f4;
  }
  h1{
    text-align:center;
    font-size:1.4rem;
    margin:4px 0 2px;
  }
  .subtitle{
    text-align:center;
    font-size:0.85rem;
    color:#555;
    margin-bottom:8px;
  }
  .map-wrapper{
    max-width:420px;
    margin:0 auto 6px;
    padding:8px;
    background:#fff;
    border-radius:16px;
    box-shadow:0 2px 6px rgba(0,0,0,.15);
  }
  .map{
    position:relative;
    width:100%;
    aspect-ratio:3/4; /* passar bra till din bild */
    border-radius:12px;
    background:#eee url("nordenkarta.png") center/contain no-repeat;
    overflow:hidden;
  }
  .pin{
    position:absolute;
    width:22px;
    height:22px;
    border-radius:50%;
    background:rgba(0,0,0,.82);
    color:#fff;
    font-size:0.75rem;
    display:flex;
    align-items:center;
    justify-content:center;
    transform:translate(-50%,-50%);
    box-shadow:0 1px 3px rgba(0,0,0,.4);
  }

  #info{
    max-width:420px;
    margin:4px auto;
    font-size:0.8rem;
    color:#444;
  }
  #score{
    max-width:420px;
    margin:4px auto;
    font-size:0.85rem;
    font-weight:600;
    text-align:center;
  }

  #list{
    max-width:420px;
    margin:0 auto;
  }
  .row{
    display:flex;
    flex-wrap:wrap;
    gap:4px;
    align-items:center;
    margin:4px 0;
    padding:5px 8px;
    background:#fff;
    border-radius:8px;
    box-shadow:0 1px 3px rgba(0,0,0,.06);
  }
  .num{
    width:20px;
    text-align:right;
    font-weight:600;
    font-size:0.8rem;
  }
  .row-label{
    font-size:0.8rem;
    flex:1 1 110px;
  }
  .inputs{
    display:flex;
    flex:1 1 150px;
    gap:4px;
  }
  input{
    flex:1 1 80px;
    min-width:80px;
    font-size:0.8rem;
    padding:3px 5px;
    border-radius:6px;
    border:1px solid #aaa;
  }
  .correct{
    border:2px solid #2a8f2a !important;
    background:#d2f4d2 !important;
  }
  .wrong{
    border:2px solid #c33 !important;
    background:#f8d6d6 !important;
  }
  .flag{
    font-size:1.1rem;
    width:24px;
    text-align:center;
  }

  #btns{
    display:flex;
    gap:6px;
    max-width:420px;
    margin:8px auto;
  }
  button{
    flex:1;
    padding:8px 0;
    border:none;
    border-radius:999px;
    font-size:0.9rem;
    cursor:pointer;
  }
  #checkAll{ background:#007aff; color:#fff; }
  #showKey{ background:#d0d0d0; }
</style>
</head>
<body>

<h1>Norden ‚Äì karta</h1>
<div class="subtitle">Titta p√• numren p√• kartan och fyll i r√§tt land, huvudstad, √∂, sj√∂ eller hav/sund/vik.</div>

<div class="map-wrapper">
  <div class="map" id="map"></div>
</div>

<div id="info">
  Platser <b>1‚Äì5</b>: land + huvudstad (tv√• rutor).<br>
  Platser <b>6‚Äì8</b>: √∂ar. Platser <b>9‚Äì11</b>: sj√∂ar.<br>
  Platser <b>12‚Äì19</b>: hav / sund / vikar.<br>
  En plats r√§knas som r√§tt f√∂rst n√§r alla f√§lt f√∂r den platsen √§r r√§tt.
</div>

<div id="score"></div>

<div id="list"></div>

<div id="btns">
  <button id="checkAll">Kolla alla</button>
  <button id="showKey">Visa facit</button>
</div>

<script>
// ======== Hj√§lpfunktioner =========
function normalize(str){
  return str
    .toLowerCase()
    .trim()
    .replaceAll("√•","a")
    .replaceAll("√§","a")
    .replaceAll("√∂","o")
    .replaceAll("¬¥","")
    .replaceAll("`","")
    .replaceAll("‚Äô","")
    .replace(/[^a-z0-9 ]+/g," ")
    .replace(/\s+/g," ");
}
function cap(s){ return s ? s.charAt(0).toUpperCase() + s.slice(1) : ""; }

// ======== 19 platser =========
// left / top √§r procent p√• DIN bild; justera vid behov.
const PLACES = [
  // 1‚Äì5: land + huvudstad
  {
    num:1,
    type:"country",
    label:"Land + huvudstad (Sverige / Stockholm)",
    left:55, top:65,
    parts:[
      {id:"sverige-land",  label:"Land", answers:["sverige"], flag:"üá∏üá™"},
      {id:"sverige-stad",  label:"Stad", answers:["stockholm"]}
    ]
  },
  {
    num:2,
    type:"country",
    label:"Land + huvudstad (Norge / Oslo)",
    left:37, top:63,
    parts:[
      {id:"norge-land",    label:"Land", answers:["norge"], flag:"üá≥üá¥"},
      {id:"norge-stad",    label:"Stad", answers:["oslo"]}
    ]
  },
  {
    num:3,
    type:"country",
    label:"Land + huvudstad (Danmark / K√∂penhamn)",
    left:45, top:86,
    parts:[
      {id:"danmark-land",  label:"Land", answers:["danmark"], flag:"üá©üá∞"},
      {id:"danmark-stad",  label:"Stad", answers:["k√∂penhamn","kopenhamn","copenhagen"]}
    ]
  },
  {
    num:4,
    type:"country",
    label:"Land + huvudstad (Finland / Helsingfors)",
    left:73, top:60,
    parts:[
      {id:"finland-land",  label:"Land", answers:["finland"], flag:"üá´üáÆ"},
      {id:"finland-stad",  label:"Stad", answers:["helsingfors","helsinki"]}
    ]
  },
  {
    num:5,
    type:"country",
    label:"Land + huvudstad (Island / Reykjavik)",
    left:18, top:33,
    parts:[
      {id:"island-land",   label:"Land", answers:["island"], flag:"üáÆüá∏"},
      {id:"island-stad",   label:"Stad", answers:["reykjavik","reykjav√≠k"]}
    ]
  },

  // 6‚Äì8: √∂ar
  {
    num:6,
    type:"island",
    label:"√ñ (Gotland)",
    left:63, top:77,
    parts:[
      {id:"gotland", label:"Namn", answers:["gotland"]}
    ]
  },
  {
    num:7,
    type:"island",
    label:"√ñ (√ñland)",
    left:59, top:83,
    parts:[
      {id:"oland", label:"Namn", answers:["√∂land","oland"]}
    ]
  },
  {
    num:8,
    type:"island",
    label:"√ñ (√Öland)",
    left:60, top:58,
    parts:[
      {id:"aland", label:"Namn", answers:["√•land","aland"]}
    ]
  },

  // 9‚Äì11: sj√∂ar
  {
    num:9,
    type:"lake",
    label:"Sj√∂ (V√§nern)",
    left:49, top:69,
    parts:[
      {id:"vanern", label:"Namn", answers:["v√§nern","vanern"]}
    ]
  },
  {
    num:10,
    type:"lake",
    label:"Sj√∂ (V√§ttern)",
    left:52, top:74,
    parts:[
      {id:"vatttern", label:"Namn", answers:["v√§ttern","vatttern"]}
    ]
  },
  {
    num:11,
    type:"lake",
    label:"Sj√∂ (M√§laren)",
    left:56, top:66,
    parts:[
      {id:"malaren", label:"Namn", answers:["m√§laren","malaren"]}
    ]
  },

  // 12‚Äì19: hav / sund / vikar
  {
    num:12,
    type:"water",
    label:"Hav (√ñstersj√∂n)",
    left:68, top:74,
    parts:[
      {id:"ostersjon", label:"Namn", answers:["√∂stersj√∂n","ostersjon"]}
    ]
  },
  {
    num:13,
    type:"water",
    label:"Hav (Nordsj√∂n)",
    left:27, top:69,
    parts:[
      {id:"nordsjon", label:"Namn", answers:["nordsj√∂n","nordsjon"]}
    ]
  },
  {
    num:14,
    type:"water",
    label:"Hav (Bottenhavet)",
    left:63, top:52,
    parts:[
      {id:"bottenhavet", label:"Namn", answers:["bottenhavet"]}
    ]
  },
  {
    num:15,
    type:"water",
    label:"Vik (Bottenviken)",
    left:65, top:42,
    parts:[
      {id:"bottenviken", label:"Namn", answers:["bottenviken"]}
    ]
  },
  {
    num:16,
    type:"water",
    label:"Vik (Finska viken)",
    left:80, top:64,
    parts:[
      {id:"finskaviken", label:"Namn", answers:["finska viken","finskaviken"]}
    ]
  },
  {
    num:17,
    type:"water",
    label:"Sund (Skagerrak)",
    left:39, top:72,
    parts:[
      {id:"skagerrak", label:"Namn", answers:["skagerrak"]}
    ]
  },
  {
    num:18,
    type:"water",
    label:"Sund (Kattegatt)",
    left:43, top:79,
    parts:[
      {id:"kattegatt", label:"Namn", answers:["kattegatt"]}
    ]
  },
  {
    num:19,
    type:"water",
    label:"Sund (√ñresund)",
    left:46, top:84,
    parts:[
      {id:"oresund", label:"Namn", answers:["√∂resund","oresund"]}
    ]
  }
];

// ======== Bygg karta + lista =========
const mapEl  = document.getElementById("map");
const listEl = document.getElementById("list");
const scoreEl = document.getElementById("score");

const FIELD_STATE = []; // ett objekt per delf√§lt

PLACES.forEach(place => {
  // pin p√• kartan
  const pin = document.createElement("div");
  pin.className = "pin";
  pin.style.left = place.left + "%";
  pin.style.top  = place.top + "%";
  pin.textContent = place.num;
  mapEl.appendChild(pin);

  // rad i listan
  const row = document.createElement("div");
  row.className = "row";

  const num = document.createElement("div");
  num.className = "num";
  num.textContent = place.num + ".";
  row.appendChild(num);

  const label = document.createElement("div");
  label.className = "row-label";
  label.textContent = place.label;
  row.appendChild(label);

  const inputsDiv = document.createElement("div");
  inputsDiv.className = "inputs";
  row.appendChild(inputsDiv);

  let flagEl = null;
  // skapa f√§lt per del (land/huvudstad eller bara namn)
  place.parts.forEach(part => {
    const inp = document.createElement("input");
    inp.placeholder = part.label;
    inputsDiv.appendChild(inp);

    FIELD_STATE.push({
      placeNum: place.num,
      partId: part.id,
      input: inp,
      answers: part.answers,
      type: place.type,
      isCountryName: !!part.flag,
      flagSymbol: part.flag || null,
      flagEl: null,   // s√§tts strax
      correct: false
    });

    inp.addEventListener("keydown", e => {
      if(e.key === "Enter"){
        checkAll();
        inp.blur();
      }
    });
  });

  // flagga l√§ngst till h√∂ger f√∂r landrader
  if (place.type === "country") {
    flagEl = document.createElement("div");
    flagEl.className = "flag";
    row.appendChild(flagEl);
    // koppla flagg-element till r√§tt del (land-namnet)
    FIELD_STATE.forEach(fs=>{
      if(fs.placeNum === place.num && fs.isCountryName){
        fs.flagEl = flagEl;
      }
    });
  }

  listEl.appendChild(row);
});

// ======== Logik =========
function checkAll(){
  // kolla alla del-f√§lt
  FIELD_STATE.forEach(fs => {
    const val = normalize(fs.input.value);
    const ok = fs.answers.some(a => normalize(a) === val);
    fs.correct = ok;
    fs.input.classList.toggle("correct", ok);
    fs.input.classList.toggle("wrong", !ok && val !== "");
  });

  // uppdatera flaggor
  PLACES.filter(p=>p.type==="country").forEach(place=>{
    const landField = FIELD_STATE.find(fs => fs.placeNum === place.num && fs.isCountryName);
    if(landField && landField.flagEl){
      landField.flagEl.textContent = landField.correct ? landField.flagSymbol : "";
    }
  });

  // r√§kna platser (alla delar f√∂r platsen m√•ste vara r√§tt)
  let correctPlaces = 0;
  PLACES.forEach(place=>{
    const parts = FIELD_STATE.filter(fs => fs.placeNum === place.num);
    if(parts.length && parts.every(fs => fs.correct)) correctPlaces++;
  });

  scoreEl.textContent = `R√§tt platser: ${correctPlaces} av ${PLACES.length}`;
}

function showKey(){
  FIELD_STATE.forEach(fs => {
    fs.input.value = cap(fs.answers[0]);
    fs.correct = true;
    fs.input.classList.add("correct");
    fs.input.classList.remove("wrong");
    if(fs.flagEl){
      fs.flagEl.textContent = fs.flagSymbol;
    }
  });
  scoreEl.textContent = `Facit visas ‚Äì ${PLACES.length} av ${PLACES.length} platser r√§tt.`;
}

document.getElementById("checkAll").addEventListener("click", checkAll);
document.getElementById("showKey").addEventListener("click", showKey);
</script>
</body>
</html>
